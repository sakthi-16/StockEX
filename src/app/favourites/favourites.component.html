<app-home></app-home>
<div style="margin-top: 10%;">
  <div *ngIf="collectionStocks && collectionStocks.length > 0; else noCollections" class="mt-5">
    <div class="d-flex justify-content-between align-items-center">
      <h4 class="mb-3">Collection: {{ collectionName }}</h4>
      <button class="btn btn-danger btn-sm" (click)="removeCollection()">Remove Collection</button>
    </div>

    <table class="table table-bordered text-center align-middle">
      <thead class="table-info">
        <tr>
          <th>Favourites</th> 
          <th>Image</th>
          <th>Stock Name</th>
          <th>Quantity</th>
          <th>Price When Added</th>
          <th>Current Price</th>
          <th>Growth Rate</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let stock of collectionStocks">
          <td>
            <button 
              class="btn btn-sm" 
              [ngClass]="{'btn-danger': recentlyRemovedStockName !== stock.stockName, 'btn-outline-light text-dark': recentlyRemovedStockName === stock.stockName}"
              (click)="removeStock(stock.stockName)">
              ü§ç
            </button>
          </td>
          <td>
            <img [src]="stock.stockImageUrl" width="50" [alt]="stock.stockName" />
          </td>
          <td>{{ stock.stockName }}</td>
          <td>{{ stock.stockQuantity }}</td>
          <td>{{ stock.stockPriceWhenAdded | currency: 'INR' }}</td>
          <td>{{ stock.currentStockPrice | currency: 'INR' }}</td>
          <td
            [ngClass]="{
              'strong-positive': stock.growthRate > 0,
              'strong-negative': stock.growthRate < 0,
              'neutral': stock.growthRate === 0
            }"
          >
            {{ stock.growthRate }}%
          </td>
        </tr>
      </tbody>
    </table>
  </div>



<!-- Remove Collection Modal -->
<div *ngIf="showUndoCollectionModal" class="modal show d-block" tabindex="-1" style="background: rgba(0,0,0,0.5);">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Undo Collection Removal</h5>
      </div>
      <div class="modal-body">
        <p>Would you like the collection to return to favorites? </p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-success" (click)="undoCollection()">Yes, Undo</button>
        <button class="btn btn-secondary" (click)="showUndoCollectionModal = false">No</button>
      </div>
    </div>
  </div>
</div>

<!-- Remove Stock Modal -->
<div *ngIf="showUndoStockModal" class="modal show d-block" tabindex="-1" style="background: rgba(0,0,0,0.5);">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Undo Stock Removal</h5>
      </div>
      <div class="modal-body">
        <p>Would you like the <strong>{{recentlyRemovedStockName}}</strong> stock to return to {{ collectionName }}? If you click <strong>No</strong> the stock will be removed <strong>permanently.</strong></p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-success" (click)="undoDeletedStock()">Yes,restore</button>
<button class="btn btn-secondary" (click)="handleStockPermanentNo()">No</button>
      </div>
    </div>
  </div>
</div>

  <!-- Template to show if collectionStocks is empty or undefined -->
  <ng-template #noCollections>
    <div class="text-center mt-5">
      <img src="assets/images/no-data.jpg" width="300" alt="No collections found" />
      <p class="mt-3 text-muted">No collections found.</p>
    </div>
  </ng-template>




  <!-- Template to show if collectionStocks is empty or undefined -->
  <ng-template #noCollections>
    <div class="text-center mt-5">
      <img src="assets/images/no-data.jpg" width="300" alt="No collections found" />
      <p class="mt-3 text-muted">No collections found.</p>
     

    </div>
  </ng-template>



<!-- Remove Collection Modal -->
<div *ngIf="showUndoCollectionModal" class="modal show d-block" tabindex="-1" style="background: rgba(0,0,0,0.5);">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Undo Collection Removal</h5>
      </div>
      <div class="modal-body">
        <p>Would you like to restore the collection "{{ collectionName }}"? If you click <strong>No</strong> collection will be removed <strong>permanently.</strong></p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-success" (click)="undoCollection()">Yes, Undo</button>
<button class="btn btn-secondary" (click)="handleCollectionPermanentNo()">No</button>
      </div>
    </div>
  </div>
</div>

<div *ngIf="showDeleteEmptyCollectionModal" class="modal show d-block" tabindex="-1" style="background: rgba(0,0,0,0.5);">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Empty Collection</h5>
      </div>
      <div class="modal-body">
        <p>{{collectionName}} collection is empty. Would you like to <strong>delete</strong> it <strong>permanently?</strong></p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-danger" (click)="deleteEmptyCollection()">Yes, Delete</button>
        <button class="btn btn-secondary" (click)="showDeleteEmptyCollectionModal = false">No</button>
      </div>
    </div>
  </div>
</div>
